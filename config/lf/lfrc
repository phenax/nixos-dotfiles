set hidden true
set drawbox true
set icons true
set ignorecase true
set relativenumber true
set ratios 2:3
set dirpreviews false

set preview true
set previewer ~/.config/lf/previewer.sh
set cursorpreviewfmt "\033[7m"

cmd open_internal ${{
    case $(file --mime-type "$f" -bL) in
        text/*|application/json) $EDITOR "$fx" ;;
        video/*|application/pdf) ~/scripts/bin/open "$f" >/dev/null 2>&1 & ;;
        *) for f in "$fx"; do
          ~/scripts/bin/open "$f" 2>/dev/null
        done ;;
    esac;
    disown 2>/dev/null;
}}
cmd open open_internal

cmd mkdir ${{
  printf "Directory Name: "
  read ans
  mkdir $ans
}}

cmd mkfile ${{
  printf "File Name: "
  read ans
  $EDITOR $ans
}}

cmd move_to_trash ${{
  mkdir -p /tmp/.trash-cache/
  echo "$fx" | while read file; do
    mv "$file" /tmp/.trash-cache/
  done;
}}

cmd show_images ${{
  if [ "$(echo "$fx" | wc -l)" = "1" ]; then
    sxiv $(dirname "$fx") &
  else
    sxiv $fx &
  fi;
}}

cmd unzip_zip ${{
  unzip $f;
}}

cmd unzip_7z ${{
  nix-zsh -p p7zip --run '7z x $f';
}}

cmd unzip_rar ${{
  NIXPKGS_ALLOW_UNFREE=1 nix-zsh -p unrar --run 'unrar x $f';
}}

# }}}

# Unset old keys {{{
  map w
  map m
  map n
  map "'"
  map '"'
  map d}}
  map c
  map e
  map d
# }}}

# Mutations
map dd      move_to_trash
map p       paste
map x       cut
map y       copy
map mf      mkfile
map md      mkdir

# View changes
map <enter> open_internal
map <c-o>   open_internal
map si      show_images
map .       :set hidden!
map st      :set sortby time; set info time
map ss      :set sortby size; set info size


# Traversal keys
map gdl   cd ~/Downloads/dl
map gdm   cd ~/Downloads/music
map gdv   cd ~/dev
map gdp   cd ~/dump
map gp    cd ~/Pictures
map gmnt  cd /run/media/imsohexy

